---
apiVersion: v1
kind: PersistentVolume
metadata:
  annotations:
    "helm.sh/hook-delete-policy": hook-succeeded
  name: esphome-pvc-claim
  namespace: iot
  labels:
    volume: esphome-pvc-claim
    name: esphome-pvc-claim
    type: longhorn
spec:
  storageClassName: longhorn-data
  capacity:
    storage: 2Gi
  accessModes:
  - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  volumeName: esphome-pv-claim
  volumeMode: Filesystem
  # hostPath:
  #   path: "/mnt/volume-0/apps/esphome"
  #   type: DirectoryOrCreate
  # nodeAffinity:
  #   required:
  #     nodeSelectorTerms:
  #     - matchExpressions:
  #       - key: kubernetes.io/hostname
  #         operator: In
  #         values:
  #         - dev-k3s-master-0
  csi:
    driver: io.rancher.longhorn
    fsType: ext4
    volumeAttributes:
      numberOfReplicates: '1'
      staleReplicaTimeout: '20'
    volumeHandle: esphome-pv-claim