---
apiVersion: v1
kind: PersistentVolume
metadata:
  # annotations:
  #   "helm.sh/hook-delete-policy": hook-succeeded
  name: pv-esphome-0
  namespace: iot
  labels:
    volume: pvc-esphome-0
    name: pvc-esphome-0
    type: longhorn
spec:
  capacity:
    storage: 2Gi
  volumeMode: Filesystem
  accessModes:
  - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  storageClassName: longhorn-data

  csi:
    driver: driver.longhorn.io #io.rancher.longhorn
    fsType: ext4
    volumeAttributes:
      numberOfReplicates: '1'
      staleReplicaTimeout: '2880'
      dataLocality: "disabled"
    volumeHandle: pvc-esphome-0

  # hostPath:
  #   path: "/mnt/volume-0/apps/esphome"
  #   type: DirectoryOrCreate
  # nodeAffinity:
  #   required:
  #     nodeSelectorTerms:
  #     - matchExpressions:
  #       - key: kubernetes.io/hostname
  #         operator: In
  #         values:
  #         - dev-k3s-master-0